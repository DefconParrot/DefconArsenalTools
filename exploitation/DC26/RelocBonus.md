# RelocBonus

Category: Exploitation

Tags: Exploitation, Obfuscator tool, windows

Tool Presented at: Defcon 26 - (Y.2018)

Author/presenter: [Nick Cano](https://twitter.com/nickcano93)

## Tool Description

![DEF CON 26 - Nick Cano - Relocation Bonus Attacking the Windows Loader](https://github.com/DefconParrot/DefconArsenalTools/assets/30528167/a918eb66-6deb-43d0-aa8b-91995d3f7640)

RelocBonus is an obfuscation tool for Windows which instruments the Windows Loader into acting as an unpacking engine.

The arbiters of defense wield many static analysis tools; disassemblers, PE viewers, and anti-viruses are among themWhen you peer into their minds, these tools reveal their perilous implementations of PE file parsing. They assume Pfiles come as-is, but the Windows Loader actually applies many mutations(some at the command of the PE itself) before execution ever begins. This talk is about bending that loader to one's whim with the Relocations Table as command spell. It will demonstrate how the loader can be instrumented into a mutation engine capable of transforminan utterly mangled PE file into a valid executable. This method starts with multiple ASLR Preselection attacks thaforce binary mapping at a predictable address. It then mangles the PE file, garbling any byte not required prior trelocation. Finally, it embeds a new Relocations Table which, when paired with a preselected base address, causes thloader to reconstruct the PE and execute it with ease.
This isn't a packer or a POC, it is a PE rebuilder which generates completely valid, stable, and vastly tool-breakinexecutables. This talk will show you how this attack twists the protocols of a machine against the controls meant tprotect it. It flexes on tools with various look-what-I-can-break demonstrations and, if you write similar toolsit'll make you rethink how you do it.

## Reference Links:

- Link to Toolâš™ï¸ => https://github.com/nickcano/RelocBonus
- Link to slideâœï¸ => https://media.defcon.org/DEF%20CON%2026/DEF%20CON%2026%20presentations/DEFCON-26-Nick-Cano-Relocation-Bonus-Attacking-the-Win-Loader.pdf
- Backup slides => https://github.com/nickcano/RelocBonusSlides
- Link to Talk(presentation)ðŸ“º => https://youtu.be/SseZ_t9DToo

## Author Description

At the time of presentantion, _Nick Cano_ is a senior security at Cylance, an author of the book, "Game Hacking: Developing Autonomous Bots for Online Games" and a [Pluralsight](https://www.pluralsight.com/) instructor(Modern C++ Secure Coding Practices: Const Correctness).

## Author's Social Links:

- [Twitter: Nick Cano (@nickcano93)](https://twitter.com/nickcano93)
- [Website](http://xenobot.net)
